"use strict";(self.webpackChunkkrebit_apidocs=self.webpackChunkkrebit_apidocs||[]).push([[684],{76295:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"webhooks/index","title":"Webhooks guide","description":"Subscribe to finance events, verify payloads, and build resilient webhook consumers.","source":"@site/docs/webhooks/index.md","sourceDirName":"webhooks","slug":"/webhooks/","permalink":"/docs/webhooks/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"description":"Subscribe to finance events, verify payloads, and build resilient webhook consumers."},"sidebar":"tutorialSidebar","previous":{"title":"Users guide","permalink":"/docs/users/"},"next":{"title":"API reference","permalink":"/docs/clients/api-reference"}}');var t=s(74848),i=s(28453);const o={sidebar_position:5,description:"Subscribe to finance events, verify payloads, and build resilient webhook consumers."},a="Webhooks guide",d={},l=[{value:"Typical workflow",id:"typical-workflow",level:2},{value:"Event catalog",id:"event-catalog",level:2},{value:"Verify signatures",id:"verify-signatures",level:2},{value:"Reliability best practices",id:"reliability-best-practices",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"webhooks-guide",children:"Webhooks guide"})}),"\n",(0,t.jsx)(n.p,{children:"Webhooks deliver near real-time updates whenever finance data changes. Use them to keep internal dashboards in sync, trigger downstream automations, or avoid polling the API for status updates."}),"\n",(0,t.jsx)(n.h2,{id:"typical-workflow",children:"Typical workflow"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Register a webhook"})," - Define the event type you care about and the target URL that should receive notifications."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Store the shared secret"})," - Creation responses include a secret. Save it securely; you will need it to verify payloads."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Handle events"})," - Expose an HTTPS endpoint that accepts POST requests, validates the signature header, and queues work for processing."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Monitor delivery"})," - Log attempts and respond quickly with ",(0,t.jsx)(n.code,{children:"2xx"})," status codes. Krebit Finance retries on transient failures and may disable webhooks that repeatedly return errors."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"event-catalog",children:"Event catalog"}),"\n",(0,t.jsxs)(n.p,{children:["Event values are defined in the API reference for your tenant. Use the values listed under ",(0,t.jsx)(n.strong,{children:"Webhooks -> WebhookStoreRequest"})," when creating a subscription. If you need new events, contact Krebit support."]}),"\n",(0,t.jsx)(n.p,{children:"Common events include:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Event"}),(0,t.jsx)(n.th,{children:"Value"}),(0,t.jsx)(n.th,{children:"When it fires"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Act created"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"act.created"})}),(0,t.jsx)(n.td,{children:"A new act is created and available for downstream processing."})]})})]}),"\n",(0,t.jsx)(n.h2,{id:"verify-signatures",children:"Verify signatures"}),"\n",(0,t.jsxs)(n.p,{children:["Webhook requests include an HMAC signature header (",(0,t.jsx)(n.code,{children:"X-Signature"}),") and the client identifier in ",(0,t.jsx)(n.code,{children:"X-Client-Id"}),". The secret returned during creation is used to compute this hash."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import crypto from 'node:crypto';\n\nfunction verifySignature(rawBody: Buffer, signature: string, secret: string) {\n  const expected = crypto\n    .createHmac('sha256', secret)\n    .update(rawBody)\n    .digest('hex');\n  return crypto.timingSafeEqual(Buffer.from(expected), Buffer.from(signature));\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Make sure your HTTP framework provides access to the ",(0,t.jsx)(n.strong,{children:"raw"})," request body. Parsing JSON before computing the signature may change whitespace and break validation."]}),"\n",(0,t.jsx)(n.h2,{id:"reliability-best-practices",children:"Reliability best practices"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Respond quickly"})," - Acknowledge requests with ",(0,t.jsx)(n.code,{children:"200"})," as soon as you enqueue work. Process the event asynchronously to avoid timeouts."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Handle retries"})," - Design idempotent consumers. Store the ",(0,t.jsx)(n.code,{children:"id"})," field included in each payload and ignore duplicates."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Secure endpoints"})," - Require HTTPS, restrict IP ranges if possible, and rotate webhook secrets on a schedule."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Test first"})," - Use tunneling tools against your tenant with test data to validate your handler before going live."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No payloads arriving"})," - Confirm your endpoint is reachable from the public internet and returns ",(0,t.jsx)(n.code,{children:"2xx"})," responses."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Signature mismatch"})," - Verify you are using the latest secret and the unmodified raw body when calculating the HMAC."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Too many retries"})," - Log attempts and error messages. Krebit Finance may disable the webhook after repeated failures; re-enable it once your handler recovers."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"When you need the exact payload structure or request fields, open the Webhooks section in the generated API reference from the sidebar."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);